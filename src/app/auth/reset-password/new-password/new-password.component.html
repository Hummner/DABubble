<div class="auth-page">
  <app-header-2></app-header-2>
  <div class="section">
    <div class="content">
      <div class="new-pw-dialog">
        <div class="title-section">
          <a [routerLink]="['/resetPassword']">
            <img src="assets/icon/arrow_back.svg" alt=""
          /></a>
          <h1 class="blue">Passwort zurücksetzen</h1>
        </div>

        <form
          [formGroup]="newPasswordForm"
          (ngSubmit)="onSubmit()"
          class="form"
          action=""
        >
          <div class="input-section">
            <div class="input-password">
              <input
                class="fs-18"
                type="password"
                formControlName="password_1"
                placeholder="Neues Passwort"
              />
              <input
                class="fs-18"
                type="password"
                formControlName="password_2"
                placeholder="Neues Kennwort bestätigen"
              />

              @if(submitted && newPasswordForm.errors?.['PasswordNoMatch']){
              <span class="error">Passwords do not match</span>
              }
              <div
                class="text-red-400 text-sm"
                *ngIf="newPasswordForm.get('password_1')?.dirty"
              >
                <ul class="error-pw-list">
                  <!-- <li
                *ngIf="
                  submitted && newPasswordForm.errors?.['PasswordNoMatch']
                "
                class="block error"
              >
                Passwords do not match
              </li> -->
                  <li
                    *ngIf="
                      !newPasswordForm
                        .get('password_1')
                        ?.value?.match('^(?=.*[A-Z])')
                    "
                    class="block error"
                  >
                    Should contain at least one uppercase letter.
                  </li>
                  <li
                    *ngIf="
                      !newPasswordForm
                        .get('password_1')
                        ?.value?.match('(?=.*[a-z])')
                    "
                    class="block error"
                  >
                    Should contain at least one lowercase letter.
                  </li>
                  <li
                    *ngIf="
                      !newPasswordForm
                        .get('password_1')
                        ?.value?.match('(.*[0-9].*)')
                    "
                    class="block error"
                  >
                    Should contain at least one digit.
                  </li>
                  <li
                    *ngIf="
                      !newPasswordForm
                        .get('password_1')
                        ?.value?.match('(?=.*[!@#$%^&*])')
                    "
                    class="block error"
                  >
                    Should contain at least one special character.
                  </li>
                  <li
                    *ngIf="
                      !newPasswordForm.get('password_1')?.value?.match('.{8,}')
                    "
                    class="block error"
                  >
                    Should be at least 8 characters long.
                  </li>
                </ul>
              </div>
            </div>
            <div class="btn-section">
              <button
                type="submit"
                [disabled]="isFormEmpty"
                [class.disabled]="isFormEmpty"
                class="fs-18 disabled"
              >
                Passwort ändern
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <app-footer></app-footer>
</div>
